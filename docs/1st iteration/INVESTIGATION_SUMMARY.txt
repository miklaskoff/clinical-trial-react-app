================================================================================
CLINICAL TRIAL EVALUATION ANOMALIES - INVESTIGATION COMPLETE
================================================================================

Investigation Date: January 25, 2026
Method: Actual Code Simulation (NO MOCKS)
Files Created:
  â€¢ investigation_script.js (executable simulation)
  â€¢ INVESTIGATION_REPORT.md (22KB comprehensive analysis)

================================================================================
FINDINGS SUMMARY
================================================================================

ISSUE 1: Missing Criterion IDs and Types in Reports
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Status:     âœ“ CONFIRMED
Severity:   LOW
Location:   src/components/App.jsx, lines 183-194
Finding:    Report formatting omits criterionId and exclusionStrength fields
Fix:        Add metadata display: "ID: ${c.criterionId}", "Type: ${c.exclusionStrength}"

ISSUE 2a: NCT06979453 Weight Exclusion Error
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Status:     âŒ CRITICAL BUG
Severity:   HIGH
Location:   Database: BMI_1916, Code: ClinicalTrialMatcher.js
Finding:    Criterion "must NOT weigh < 30kg" mislabeled as exclusion
Root Cause: EXCLUSION_STRENGTH: "mandatory_exclude" (should be "inclusion")
Impact:     Patient with 71kg incorrectly EXCLUDED from trial
Fix:        Update database: BMI_1916.EXCLUSION_STRENGTH = "inclusion"

ISSUE 2b: NCT07116967 Complex Cardiovascular Criterion
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Status:     ğŸ“‹ DESIGN LIMITATION
Severity:   MEDIUM
Location:   Database: AGE_2033
Finding:    OR-logic criterion with 7+ sub-conditions stored as single entry
Limitation: Cannot evaluate sub-conditions independently
Behavior:   Relies on AI fallback for semantic understanding
Fix:        Optional enhancement - split or add OR-handling logic

ISSUE 2c: NCT06477536 GPP Flare Cluster
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Status:     âœ… NO ISSUE FOUND
Severity:   NONE
Location:   Database: FLR_2292
Finding:    Criterion CORRECTLY assigned to FLR (Flare) cluster
Structure:  Properly slot-filled with CONDITION_TYPE, CONDITION_PATTERN
Fix:        None required

ISSUE 2d: NCT05092269 SARS-CoV-2 Criterion Parsing
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Status:     âœ… NO ISSUE FOUND
Severity:   NONE
Location:   Database: AIC_1377
Finding:    Sub-conditions properly extracted into arrays
Quality:    Has LOGICAL_OPERATOR: "OR", proper CONDITION_PATTERN variants
Fix:        None required

ISSUE 2e & 4: NCT07150988 Breast Cancer Exclusion
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Status:     âš ï¸ POTENTIAL GAP
Severity:   MEDIUM
Location:   src/utils/index.js arraysOverlap(), drugDatabase.js findSynonyms()
Finding:    Synonym system exists but requires exact string match
Issue:      "breast cancer" â†’ synonyms: ["tumor", "malignancy"]
            "malignant tumors" (criterion) â‰  "tumor" (synonym)
            No overlap detected due to exact match requirement
Fix:        Option A: Enhance arraysOverlap() with substring matching
            Option B: Expand medical-synonyms.json with specific mappings
            Option C: Normalize database condition terms

ISSUE 3: NCT06630559 Confidence 90%
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Status:     âœ… WORKING AS DESIGNED
Severity:   NONE
Location:   src/config/matching-rules.json, RulesLoader.js
Finding:    Confidence correctly calculated per matching rules
Logic:      Match type: "noMatch" (patient doesn't match exclusion)
            Configured confidence: 0.9 (90%)
            High confidence patient does NOT violate exclusion
Fix:        None required - system behaving correctly

================================================================================
PRIORITY ACTIONS
================================================================================

IMMEDIATE (Critical):
  1. Fix NCT06979453 weight criterion database entry
     â€¢ Update BMI_1916.EXCLUSION_STRENGTH to "inclusion"
     â€¢ Add WEIGHT_MIN: 30.0 field
     â€¢ Test with 71kg patient

HIGH PRIORITY:
  2. Enhance report formatting (Issue 1)
     â€¢ Add criterion ID and type display
  3. Improve synonym matching (Issue 2e/4)
     â€¢ Enhance arraysOverlap() OR expand synonyms

MEDIUM PRIORITY:
  4. Handle OR-logic criteria (Issue 2b)
     â€¢ Document AI fallback behavior

LOW PRIORITY:
  5. Documentation updates
     â€¢ Note Issues 2c, 2d as correctly implemented

================================================================================
VERIFICATION
================================================================================

Evidence Generated:
  âœ“ investigation_script.js executed successfully
  âœ“ Actual database entries examined (improved_slot_filled_database.json)
  âœ“ Code paths traced through ClinicalTrialMatcher.js
  âœ“ Configuration files analyzed (matching-rules.json, medical-synonyms.json)
  âœ“ Synonym matching logic verified (drugDatabase.js, RulesLoader.js)

Simulation Results:
  âœ“ BMI_1916 criterion: EXCLUSION_STRENGTH = "mandatory_exclude" (wrong)
  âœ“ FLR_2292 criterion: Correctly in FLR cluster
  âœ“ AIC_1377 criterion: Properly parsed with OR-logic
  âœ“ Confidence calculation: 90% = noMatch per matching-rules.json
  âœ“ Synonym system: "cancer" â†’ ["tumor", "malignancy"] (partial coverage)

================================================================================
CONCLUSION
================================================================================

Investigation completed using ACTUAL CODE SIMULATION (no mocks).

Most Critical: Issue 2a (weight criterion) requires immediate database fix
Most Interesting: Issues 2c and 2d are actually working correctly
Design Insight: Synonym matching works well for exact matches but needs
                enhancement for compound terms

All findings documented in INVESTIGATION_REPORT.md with code references.

================================================================================
Generated: January 25, 2026
Method: Factual Code Simulation
Files Analyzed: 12 source files, 1 database, 4 config files
Test Simulations: 7 scenarios
================================================================================
